# 2024-12-09

리액트 17

특징 : 16 버전과 비교하면 새롭게 추가된 기능은 없으며 호환성이 깨지는 변경 사항, 즉 기존에 사용하던 코드의 수정을 필요로 하는 변경 사항을 최소화하였다.

16 버전에서 17 버전으로의 업그레이드는 큰 부담 없이 할 수 있다.

리액트 17부터는 점진적인 업그레이드가 가능하다.

일부 트리와 컴포넌트에 대해서만 리액트 18을 선택하는 점전적인 버전 업이 가능

관리측면에서는 비효율이지만, 새로운 버전으로 한꺼번에 업그레이드하기 부담스러울 때는 유용하다

이벤트 위임 방식의 변경

```javascript
useEffect(() => {
    if (buttonRef.current) {
        buttonRef.current.onclick = function click() { alert("안녕하세요!")
        }
    }
}, [])

const handleClick = () => {
}

<button onClick={handleClick}>리액트 버튼</button>
<button ref={buttonRef}>그냥 버튼 </button>

```

'리액트 버튼'은 DOM에 이벤트를 추가하는 방식으로 onclick 이벤트 사용

- 버튼의 onClick 이벤트에 noop이라는 핸들러가 추가

'그냥 버튼'은 직접 DOM을 참조해서 DOM의 onclick에 직접 합수를 추가

- 해당 버튼의 이벤트 리스너에 click으로 추가

리액트는 이벤트 핸들러를 해당 이벤트 핸들러를 추가한 각각의 DOM 요소에 부탁하는 것이 아니라, 이벤트 타입당 하나의 핸들러를 루트에 부착한다. (이벤트 위임, 이벤트 핸들러를 각 요소가 아닌 document에 연결)

이벤트 위임은 다음의 이벤트 단계 원리를 활용해 이벤트를 상위 컴포넌트에만 붙이는 것을 의미한다.

1. 캡처: 이벤트 핸들러가 트리 최상단 요소에서부터 시작해서 실제 이벤트가 발생한 타깃 요소까지 내려가는 것

2. 타깃: 이벤트 핸들러가 타깃 노드에 도달하는 단계. 이 단계에서 이벤트 호출

3. 버블링: 이벤트가 발생한 요소에서부터 시작해 최상위 요소까지 다시 올라간다.

리액트 16 버전까지는 이벤트 위임이 모두 document에서 수행

=> 리액트 17부터는 이벤트 위임이 모두 document가 아닌 리액트 컴포넌트 최상단 트리, 즉 루트 요소로 변경

변경된 이유는 뭘까?

1. 점진적 업그레이드 지원
   이전에는 React를 점진적으로 업그레이드하는 것이 어려웠다. React 16까지는 이벤트가 document에 위임되었기 때문에, 같은 페이지에서 React의 다른 버전을 사용하는 경우 이벤트 시스템이 충돌할 가능성이 있다.
   React 17에서는 이벤트를 루트 컨테이너에서 관리하도록 변경함으로써, 페이지에 React의 여러 버전을 동시에 사용할 수 있게 되었다.
2. 기존 DOM 이벤트와의 충돌 방지
   document에 이벤트 리스너를 등록하면 React 외부의 코드(다른 바닐라 자바스크립트 코드 또는 jQuery)와 충돌하거나 예상치 못한 버그가 발생할 수 있다. React 17에서 이벤트 위임을 루트 컨테이너로 이동하면, React 외부 코드와의 충돌 가능성이 줄어든다.

루트 요소로 변경됨에 따라 각 이벤트는 해당 리액트 컴포넌트 트리 수준으로 격리되므로 이벤트 버블링으로 인한 혼선을 방지할 수 있다.
